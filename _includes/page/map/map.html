
<script >

mapboxgl.accessToken = 'pk.eyJ1IjoiaGFtaXNoamdyYXkiLCJhIjoiY2pkbjBmeGN6MDd1YzMzbXI3cWdpNThjayJ9.3YE8T1H2QUyqNIkxdKWxkg';

var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/hamishjgray/cjsa3lvv75rtq1fof78nik8bv',
   // style: 'mapbox://styles/mapbox/light-v10',
    center: [54.0989, 23.852510],
    zoom: 5,
    minZoom: 5,
    //maxZoom: 16
  });



  this.map.on('load', () => {
          this.map.resize();
  });
  
map.addControl(new mapboxgl.NavigationControl());

map.on('load', function() {
  // Insert the layer beneath any symbol layer.
  var layers = map.getStyle().layers;

  var labelLayerId;
  for (var i = 0; i < layers.length; i++) {
  if (layers[i].type === 'symbol' && layers[i].layout['text-field']) {
  labelLayerId = layers[i].id;
  break;
  }
  }

  map.addLayer({
  'id': '3d-buildings',
  'source': 'composite',
  'source-layer': 'building',
  'filter': ['==', 'extrude', 'true'],
  'type': 'fill-extrusion',
  'minzoom': 7,
  'paint': {
    'fill-extrusion-color': '#aaa',
      // use an 'interpolate' expression to add a smooth transition effect to the
      // buildings as the user zooms in
      'fill-extrusion-height': [
        "interpolate", ["linear"], ["zoom"],
          7, 0,
          7.05, ["get", "height"]
        ],
      'fill-extrusion-base': [
          "interpolate", ["linear"], ["zoom"],
          7, 0,
          7.05, ["get", "min_height"]
        ],
      'fill-extrusion-opacity': .5
      }
  }, labelLayerId);




  });



  // code from the next step will go here!
  var geojson = {
    type: 'FeatureCollection',
    features: [

  /************** Abenteurer ************/
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.605766, 24.471706]
    },
    properties: {
      title: 'Formel 1',
      id: 'abenteuer',
      img: 'one',
      link: 'http://bit.ly/2JLu2YH',
      description: 'Einen Blick hinter die Kulissen des großen Formel 1 Abu Dhabi Grand Prix werfen.'
    }
    },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [53.785847, 22.980556]
    },
    properties: {
      title: 'Tel Moreeb',
      id: 'abenteuer',
      img: 'two',
      link: 'http://bit.ly/2CAawbw',
      description: 'Verheißungsvolle Abflüge wagen Pistenpiloten beim Sandboarding auf der gewaltigen Düne Tel Moreeb.'
    }
  },
  {
      type: 'Feature',
      geometry: {
        type: 'Point',
        coordinates: [54.60035712, 24.49257612]
      },
      properties: {
        title: 'Warner Bros. World',
        id: 'abenteuer',
        img: 'three',
        link: 'http://bit.ly/2FofOHo',
        description: 'Im weltgrößten Freizeitpark tauchen Filmfreunde in die Welt der Cartoons und Trickfilmstars ab.'
      }
    },
  {
      type: 'Feature',
      geometry: {
        type: 'Point',
        coordinates: [54.59581723, 24.48991760]
      },
      properties: {
        title: 'Waterworld',
        id: 'abenteuer',
        img: 'four',
        link: 'http://bit.ly/2unwbis',
        description: 'Erleben Sie einen unvergesslichen Tagesausflug im futuristische Wasserpark mit 43 Attraktionen.'
      }
    },
  {
      type: 'Feature',
      geometry: {
        type: 'Point',
        coordinates: [55.7388979, 24.0939466]
      },
      properties: {
        title: 'Wadi Adventure Park',
        id: 'abenteuer',
        img: 'five',
        link: 'http://bit.ly/2unwbis',
        description: 'Paddeln Sie sich durch tosende, künstlich angelegte Stromschnellen und Wildwasserkanäle. '
      }
    },

  /************** Kultur ************/
{
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.392864, 24.446565]
    },
    properties: {
      title: 'Scheich-Zayid-Moschee',
      id: 'kultur',
      img: 'one',
      link: 'http://bit.ly/2CtblT9',
      description: 'Wie ein Gesamtkunstwerk aus 1001 Nacht leuchtet das elfenbeinfarbene Symbol der islamischen Welt.'
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.398495, 24.533737]
    },
    properties: {
      title: 'Louvre Abu Dhabi',
      id: 'kultur',
      img: 'two',
      link: 'http://bit.ly/2Ojmniz',
      description: 'Besuchen Sie berühmte Meisterwerke unter dem verzaubernden Lichtspiel der Kuppel aus Metall-Netzen.'
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [55.7679216, 24.2148316]
    },
    properties: {
      title: 'Al Ain Oase',
      id: 'kultur',
      img: 'three',
      link: 'http://bit.ly/2HAjCcg',
      description: 'Unesco-Erbe und blühendes Gegenstück zur allgegenwärtigen Wüste: Oasenstadt Al Ain. '
  }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.3552162863, 24.4815661797]
    },
    properties: {
      title: 'Qasr Al Hosn',
      id: 'kultur',
      img: 'four',
      link: 'http://bit.ly/2UReZ0j',
      description: 'Besuchen Sie das aus Korrallenstein gebaute und mit Muscheln verzierte Wahrzeichen Qasr al Hosn. '
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.3552162863, 24.4815661797]
  },
    properties: {
      title: 'Qasr Al Hosn',
      id: 'kultur',
      img: 'four',
      link: 'http://bit.ly/2UReZ0j',
      description: 'Besuchen Sie das aus Korrallenstein gebaute und mit Muscheln verzierte Wahrzeichen Qasr al Hosn. '
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.31160057, 24.45632553]
  },
    properties: {
      title: 'Qasr Al Watan',
      id: 'kultur',
      img: 'five',
      link: 'http://bit.ly/2Fu3qqI',
      description: 'Der orientalische Präsidentenpalast Qasr Al Watan öffnet für Touristen seine prachtvollen Pforten. '
    }
  },
      /************** Natur ************/
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.4369574, 24.54888505]
    },
    properties: {
      title: 'Saadiyat Beach',
      id: 'natur',
      img: 'one',
      link: 'http://bit.ly/2FsvDOz',
      description: 'Natürliche Dünenvegetation, weißer Sandstrand und Karettschildkröten: ein Weltklasse-Resort.'
    }
  },
  {
  type: 'Feature',
  geometry: {
    type: 'Point',
    coordinates: [54.42289114, 24.45479388]
  },
  properties: {
    title: 'Mangrove National Park',
    id: 'natur',
    img: 'two',
    link: 'http://bit.ly/2Yey4Me',
    description: 'Rosa Flamingos, grüne Salzwiesen und Seekühe erwarten Sie im Mangroven National Park.'
    }
  },
  {
  type: 'Feature',
  geometry: {
    type: 'Point',
    coordinates: [52.600984, 24.3209933]
  },
  properties: {
    title: 'Arabian Wildlife Park',
    id: 'natur',
    img: 'three',
    link: 'http://bit.ly/2Wf0vYD',
    description: 'Beobachten Sie arabische Oryx-Antilopen, Gazellen sowie Hyänen und Geparden auf Wildlife-Tour. '
    }
  },
  {
  type: 'Feature',
  geometry: {
    type: 'Point',
    coordinates: [54.698736, 24.411928]
  },
  properties: {
    title: 'Falkenklinik',
    id: 'natur',
    img: 'four',
    link: 'http://bit.ly/2Uaw8W1',
    description: 'Eine Besichtigungs-Tour offenbart Ihnen Einblicke in die Geschichte und Tradition der Falknerei. '
    }
  },

  /************** Cities ************/
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.4252157, 24.5378710]
    },
    properties: {
      title: 'The Collection',
      id: 'cities',
      img: 'one',
      link: 'http://bit.ly/2Oh69Xg',
      description: 'Willkommen im mediterranen Shopping-Dorf: Hochkarätige Boutiquen umgeben von Piazzas und Terrassen. '
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.434665949, 24.418703203]
    },
    properties: {
      title: 'Capital Gate',
      id: 'cities',
      img: 'two',
      link: 'http://bit.ly/2HzFt3I',
      description: 'Der am stärksten absichtlich geneigte Turm der Welt bringt Sie zum Staunen.'
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.317479423, 24.462374628]
    },
    properties: {
      title: 'Emirates Palace',
      id: 'cities',
      img: 'three',
      link: 'http://bit.ly/2Tmw0hn',
      description: 'Das Emirates Palace Hotel überzeugt mit herausragendem Design und unübertroffenem Service.'
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.318464235, 24.457059812]
    },
    properties: {
      title: 'Etihad Towers',
      id: 'cities',
      img: 'four',
      link: 'http://bit.ly/2HzFt3I',
      description: 'Schwindelfreie riskieren einen Blick aus dem 74. Stockwerk und genießen die atemberaubende Aussicht.'
    }
  },
  {
    type: 'Feature',
    geometry: {
      type: 'Point',
      coordinates: [54.339467, 24.473281]
    },
    properties: {
      title: 'Strandpromenade Corniche',
      id: 'cities',
      img: 'five',
      link: 'http://bit.ly/2U4Z15Q',
      description: 'Mit prächtigem Blick auf die Skyline Abu&nbsp;Dhabis lädt die paradiesische Corniche zum Relaxen ein.'
    }
  }
    ]
  };

  	// add markers to map
  geojson.features.forEach(function(marker) {

    // create a HTML element for each feature
    /**/var el = document.createElement('a');
    //el.innerHTML = 'onlick';

    //document.body.appendChild(el);
    el.className = 'marker marker--'+marker.properties.id;
    el.id = marker.properties.id+'-'+marker.properties.img;


  /*  */
  	//alert(marker.properties.id);

    // make a marker for each feature and add to the map
  new mapboxgl.Marker(el)
    .setLngLat(marker.geometry.coordinates)
    .setPopup(new mapboxgl.Popup({ offset: 25 }) // add popups
      .setHTML('<a href="'+marker.properties.link+'"><img src="{{site.img}}/content/'+marker.properties.id+'/bg-'+marker.properties.img+'.jpg"><div class="bv-popup "><div class="text text--md text--black text--bold text--upper text--left" >' + marker.properties.title + '</div><div class="text text--sm text--black">' + marker.properties.description + '<span class="text--red text--bold"> Mehr&nbsp;erfahren</span></div></div></a>'))
    .addTo(map);
  });



</script>
